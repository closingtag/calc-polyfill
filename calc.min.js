!function(win,doc){"use strict";if(doc.querySelectorAll){var elements={onload:[],onwinresize:[],ontextresize:[]},EMPTY="",CSS_COMMENT=/(\/\*[^*]*\*+([^\/][^*]*\*+)*\/)\s*?/g,NEW_LINE=/\n/g,CALC_RULE=/\s?(\-webkit\-)?calc/,CALC_EXTR_RULE=/\s?(\-webkit\-)?calc\((.*?)\)/,MATH_EXP=/[\+\-\/\*]?\d+(px|%|em|rem)?/g,PERCENT=/\d+%/,PIXEL=/(\d+)px/g,REMEM=/\d+r?em/,REM=/\d+rem/,EM=/\d+em/,PLACEHOLDER="$1",ONLYNUMBERS=/[\s\-0-9]/g,util={arr:{forEach:function(a,b,c){if("forEach"in Array.prototype)a.forEach(b,c);else for(var d=0,e=a.length;e>d;d++)d in a&&b.call(c,a[d],d,a)}},string:{camelize:function(a){return a.replace(/\-(\w)/g,function(a,b){return b.toUpperCase()})},trim:function(a){var b=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;return String.prototype.trim?a.trim():a.replace(b,"")}},style:{get:function(a,b){return a.currentStyle?a.currentStyle[util.string.camelize(b)]:doc.defaultView&&doc.defaultView.getComputedStyle?doc.defaultView.getComputedStyle(a,null).getPropertyValue(b):a.style[util.string.camelize(b)]},get_font_size:function(a){var b,c=doc.createElement("span");return c.innerHTML="&nbsp;",c.style.position="absolute",c.style.lineHeight="1",c.style.fontSize="1em",a.appendChild(c),b=c.offsetHeight,a.removeChild(c),b}},xhr:function(){if(win.XMLHttpRequest)return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(a){return null}}(),event:{add:function(a,b,c){doc.addEventListener?a.addEventListener(b,c,!1):a.attachEvent("on"+b,c)},remove:function(a,b,c){document.removeEventListener?a.removeEventListener(b,c,!1):a.detachEvent("on"+b,c)},content_loaded:function(a,b){var c=!1,d=!0,e=a.document,f=e.documentElement,g=e.addEventListener?"addEventListener":"attachEvent",h=e.addEventListener?"removeEventListener":"detachEvent",i=e.addEventListener?"":"on",j=function(d){("readystatechange"!=d.type||"complete"==e.readyState)&&(("load"==d.type?a:e)[h](i+d.type,j,!1),!c&&(c=!0)&&b.call(a,d.type||d))},k=function(){try{f.doScroll("left")}catch(a){return setTimeout(k,50),void 0}j("poll")};if("complete"==e.readyState)b.call(a,"lazy");else{if(e.createEventObject&&f.doScroll){try{d=!a.frameElement}catch(l){}d&&k()}e[g](i+"DOMContentLoaded",j,!1),e[g](i+"readystatechange",j,!1),a[g](i+"load",j,!1)}}},text_resize:function(){var a,b,c,d,e=200,f=function(){a=doc.createElement("span"),a.id="text-resize-control",a.innerHTML="&nbsp;",a.style.position="absolute",a.style.left="-9999px",a.style.lineHeight="1",a.style.fontSize="1em",doc.body.insertBefore(a,doc.body.firstChild),b=a.offsetHeight},g=function(){var c=a.offsetHeight;c!==b&&(b=c,d&&doc.body.dispatchEvent(d))},h=function(){d||(doc.createEvent?(d=doc.createEvent("Event"),d.initEvent("textresize",!0,!0)):"function"==typeof Event&&(d=new Event("textresize")))},i=function(){c||(c=win.setInterval(g,e))},j=function(){win.clearInterval(c),c=null};return{init:function(){f(),h()},start:function(){i()},stop:function(){j()}}}()},load_stylesheet=function(a){return util.xhr.open("GET",a,!1),util.xhr.send(),200==util.xhr.status?util.xhr.responseText:EMPTY},parse_stylesheet=function(a){var b=[];a=a.replace(CSS_COMMENT,EMPTY).replace(NEW_LINE,EMPTY),b=a.split("}"),util.arr.forEach(b,function(a){var b=a.split("{")[0],c=b.length>1?doc.querySelectorAll(b):"",d=[],e="",f="";if(a.match(CALC_RULE)&&0!==c.length){d=a.split("{")[1].split(";"),util.arr.forEach(d,function(a){a.match(CALC_RULE)&&(e=a.split(":")[0],f=a.split(":")[1])});for(var g=0;g<c.length;g++)f.match(CALC_EXTR_RULE)[2].match(PERCENT)&&elements.onwinresize.push({element:c[g],prop:e,values:f}),f.match(CALC_EXTR_RULE)[2].match(REMEM)&&elements.ontextresize.push({element:c[g],prop:e,values:f}),f.match(CALC_EXTR_RULE)[2].match(PIXEL)&&elements.onload.push({element:c[g],prop:e,values:f})}})},calc=function(obj){var formula=obj.values.match(CALC_EXTR_RULE)[2].replace(PIXEL,PLACEHOLDER),matches=formula.match(MATH_EXP),result;matches&&util.arr.forEach(matches,function(a){var b,c;a.match(PERCENT)&&(b=obj.element.parentNode.clientWidth,c=parseInt(a,10)/100,formula=formula.replace(a,b*c)),a.match(EM)&&(b=obj.element.currentStyle?util.style.get_font_size(obj.element):parseInt(util.style.get(obj.element,"font-size").replace(/px/,EMPTY),10),c=parseInt(a,10),formula=formula.replace(a,b*c)),a.match(REM)&&(b=util.style.get(doc.body,"font-size").match(PERCENT)?16*parseInt(util.style.get(doc.body,"font-size").replace(/%/,EMPTY),10)/100:parseInt(util.style.get(doc.body,"font-size").replace(/px/,EMPTY),10),c=parseInt(a,10),formula=formula.replace(a,b*c))});try{formula.match(ONLYNUMBERS)&&(result=eval(formula)),obj.element.style[util.string.trim(util.string.camelize(obj.prop))]=obj.values.replace(CALC_EXTR_RULE," "+result+"px")}catch(e){}},get_style_sheets=function(){for(var b,c=0;c<doc.styleSheets.length;c++)b=doc.styleSheets[c],b.href&&b.href!=EMPTY&&parse_stylesheet(load_stylesheet(b.href))};util.event.content_loaded(win,function(){get_style_sheets(),0!==elements.onload.length&&util.arr.forEach(elements.onload,function(a){calc(a)}),0!==elements.onwinresize.length&&util.arr.forEach(elements.onwinresize,function(a){calc(a),util.event.add(win,"resize",function(){calc(a)})}),0!==elements.ontextresize.length&&util.arr.forEach(elements.ontextresize,function(a){calc(a),util.event.add(doc.body,"textresize",function(){calc(a)}),util.text_resize.init(),util.text_resize.start()})})}}(window,document);